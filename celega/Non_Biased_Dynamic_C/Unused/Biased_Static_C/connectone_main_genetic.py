import gym
import numpy as np
import matplotlib.pyplot as plt
import math
from c_worm import *
from celegan_env import WormSimulationEnv
from trained_connectome_with_bias import all_neuron_names
from Genetic_running import GeneticRUN
# Genetic Algorithm parameters
gene = [-2.37086660e+01, -1.67505225e+01, 5.23873431e+00, 3.77699453e+00, -8.49404052e+00, -5.06791107e+00, 1.31208916e+00, -8.85593610e+00, -9.30135579e+00, -1.97488552e+01, 1.55388177e+01, -1.75759135e+01, -8.16853504e+00, -7.66600404e+00, 2.87293966e+01, -7.91007165e+00, -2.44315534e+01, 1.26592390e+01, -7.74504123e+00, 2.29490619e+01, -1.85260650e+01, -2.78710284e+01, 8.48371510e+00, 2.62932046e+01, 2.85942338e+01, 3.72995529e+00, -1.45338686e+01, 2.70009582e+01, 6.74815315e+00, 9.03775634e+00, -3.29802683e+00, 1.72853286e+01, 1.18920831e+01, -3.12844371e+01, -1.36957772e+01, 5.35595045e+00, -1.45804906e+01, -6.87044293e+00, -1.29253521e+01, 1.29713575e+01, 4.94744646e+00, 6.11173154e+00, 7.99690871e+01, 2.18414254e-01, -3.66101392e+00, 1.15187792e+01, -2.25139465e+00, -4.83625734e+01, -2.64087548e+01, -1.87105343e+01, 6.12972538e+00, 1.98923650e+01, -3.23887485e+00, -3.01381819e+01, -5.21915931e+00, 6.61490784e+00, -1.02555087e+01, -3.29831586e+00, -1.63327733e+01, -3.36979456e+01, -1.85379108e+01, -1.45098097e+00, 1.71029622e+01, -1.64050003e+01, -1.27970011e+01, 1.14687821e+01, -9.63857757e+00, 2.15885638e+01, -4.36566425e+01, 2.49163592e+01, -3.57378829e+01, -1.95723142e-01, -2.22549719e+01, 2.31152652e+00, -1.77468133e+01, 6.61481106e+01, 4.90498242e+01, -2.94738270e+01, 7.10955891e+01, -3.55383740e+01, -3.08102434e+01, 8.45432865e-01, -2.02614367e+01, 8.70317944e+01, -1.26448962e+02, 4.93723362e+00, -5.76108285e+00, -8.50598290e+00, -1.38962556e+00, -4.24074054e+01, -1.51066740e-01, 6.32775517e-01, -5.83038776e+00, -1.75130882e+01, 1.33084616e+01, 7.74590778e+00, 1.62514784e+02, -1.79498219e+01, -1.04289452e+01, -7.94544714e+00, -4.70789102e+00, 8.23068047e-01, -7.69961515e+01, 1.09651913e+01, 3.50434505e+01, 7.12958665e-01, 3.76219678e+01, -2.61140757e+01, -2.09522353e+02, -3.41584478e+01, -6.03858384e-01, -5.21072601e+01, -8.23574467e-01, 9.70866160e+00, -1.21616056e+01, 3.13146581e+01, -5.47426947e+00, -9.17125161e+00, 1.01938222e+01, 2.91420091e+01, -2.40315586e+01, -1.79890577e+01, 2.36448395e+01, -5.62246895e+00, -3.21213541e+00, -1.74499049e+01, -4.24444285e+01, 1.74176903e+01, 9.25833888e+00, -2.53009420e+02, -1.53001555e+00, -1.98727789e+00, -1.78362448e+02, 1.98655235e+04, 1.86913040e+01, 2.33369252e+01, 1.74418069e+01, -1.86344530e+01, -8.65336077e+00, 1.90955925e+02, -2.89309158e+02, 1.50221725e+01, -2.30834398e+00, -2.67372163e+01, 9.46473868e+00, -7.13518152e+01, 1.03738203e+00, -8.71136146e+00, -4.21436512e+01, -8.19334943e+00, -1.07456106e+01, 3.80594593e+00, 1.33304856e+01, -6.84759164e+00, 1.42082636e+01, -6.17848634e+01, 8.36408158e-01, -8.98934365e+00, -5.75681836e+01, 1.07952043e+02, -1.05871038e+02, -1.22153102e+01, -8.85376039e-01, -3.51413247e+01, 4.56883516e+00, -1.44252153e+01, -4.60225395e+00, 6.44543330e+00, 9.45329295e+01, 2.29197943e+00, -7.65018767e-01, -1.02351832e+01, 7.69922539e+00, 8.72656134e+00, -1.16536765e+01, 6.14190236e+00, -1.81118524e+01, 3.26901185e+01, 2.10573410e+02, -1.25714375e+01, -1.01496902e+01, -8.17256452e+00, -2.54109804e+01, 2.07129956e+01, -7.32512166e+01, -1.39083921e+01, -1.70468181e+01, 1.06253104e+01, -2.28843210e+01, 6.72435000e+00, -1.26402702e+01, -7.34783661e+00, -9.99695475e+00, -3.36232331e+01, -4.31834499e+00, 1.63064495e+01, -1.21683149e+00, 2.30681487e+01, 6.54114545e+00, 1.34998224e+01, -1.36222538e+01, 2.22091661e+01, -1.79243098e+01, 2.09299206e+00, -1.22801023e+01, -4.27153007e+00, -1.13636860e+01, 1.21204561e+01, 1.08864499e+01, -4.64859447e+00, -4.59930288e+00, -1.72360492e+01, -2.89285700e+00, -9.04977911e+00, 2.83342542e+00, 2.93383981e+00, -1.05350100e+01, 2.11888107e+02, 7.84520333e+01, 9.86534459e+00, -2.15312429e+01, 5.53805002e+00, 3.76509715e+00, -2.93198624e+00, 1.54304776e-01, 9.06993749e+00, -2.44469899e+00, 3.65935838e+01, -5.28570667e+01, -3.63319202e+00, -1.34789829e+01, -7.75216284e+00, 2.12549579e+01, 3.47670697e+00, -9.89804998e-01, -2.07542557e-01, -1.89194433e+01, 3.82856189e+00, -2.06254240e+01, 8.82004718e+00, 2.41628197e+00, -2.13943668e+00, -2.39143620e+01, -1.72127380e+01, -2.04630083e+01, 1.67066946e+01, -9.08650491e-02, 1.91199697e+01, -1.29284490e+01, 1.51952434e+01, -1.30194164e+01, -2.39657854e+02, 1.49576207e+01, 7.50175422e+00, -8.50829972e+00, 6.29192179e+00, 4.08948845e+01, 3.57638364e+01, -3.38558426e-01, -2.03319878e+00, 1.19441623e+01, -1.19428449e+00, 2.02029465e+01, -7.62853394e+01, -1.81262713e+01, 1.75035994e+01, -3.13452144e+01, 4.43223742e-01, -1.74557326e+01, 7.68383380e+00, 4.57755463e+01, 1.32493534e+01, -1.30167777e+01, 7.29372705e+00, 1.30054347e+01, -6.30710480e+00, -6.52134183e+00, -1.02739756e+01, 8.69980173e-01, -8.47210600e+00, 2.79982095e+01, -1.18500411e+01, 4.57164108e+00, 4.54781676e+00, -2.73194605e+01, 2.01901825e+01, -1.71513214e+00, -1.04362732e+01, -1.43014144e+01, -1.31539715e+01, 1.10951161e+06, -3.27212761e+00, -1.04545918e+01, 7.66745851e+01, 3.17100067e-01, -3.30310632e+00, 1.90178434e+00, 2.25778688e+02, 3.02993461e+02, 8.00507057e+00, 6.53915854e-01, 6.49808286e+00, 8.78795430e+00, 9.00648375e+00, 2.14999329e+01, 6.97185714e+00, -4.81068171e+02, -5.76231447e+01, 6.75131150e+00, -4.55719090e+01, 6.68954099e+00, 9.88627675e+00, -5.75285895e+00, 2.31871366e+01, -1.59866427e+01, 1.85011753e+01, 3.23870755e+00, -2.56642306e+01, 5.54071990e+00, -1.07450627e+00, 2.87938133e+01, -1.45834943e+01, 7.65294776e+00, 1.29336120e+01, -4.30378619e+00, -5.76299996e+00, 5.20419744e+00, -1.35865620e+01, 3.46880482e+01, -1.37478794e+01, -1.32139312e+00, -1.54614317e+01, -1.05686157e+00, 1.81650955e+01, 1.35611234e+01, 1.56916037e+01, -3.52546391e+01, 1.16442776e+01, -1.03992314e+00, -8.58674527e+00, -8.19283550e+00, -3.62620428e+01, -2.92887952e+00, 2.32287856e+00, 4.69903303e+00, 8.50903735e-01, 1.08593644e+01, -1.21774036e+01, 5.92180289e+00, -7.05303916e+00, 1.77831699e+01, -5.77647403e+00, -5.54733270e+01, 1.04375560e+01, 1.80109550e+00, -1.83320126e+01, -1.93644624e+01, 6.97195674e+00, -3.45417951e+01, -6.38562645e+00, 2.48636839e+01, -3.11243948e+00, -5.01242485e+00, 3.85039857e+00, 7.26735633e+00, 3.22204404e+00, 4.52643349e+00, -2.09024784e+00, 7.81264875e+00, 4.12317822e+01, -4.69783812e+00, -2.25622586e+01, 1.47027448e+01, -8.67108224e+00, -1.39188625e+01, 4.33936078e+00, 9.07196492e+00, -2.70088765e+00, 9.49351206e+00, -5.04864846e-01, 2.12363538e+00, -5.03837172e+01, 1.27440768e+01, 3.27120162e+01, 3.02993637e-01, 2.70692356e+00, -7.91078526e+00, 1.98801740e+00, 1.36330269e+00, 1.48952135e+00, 1.03923010e+01, -1.31361684e+01, -2.72552640e+01, -1.48864116e+01, -1.40671825e+01, 2.29140596e+01]
from Genetic_TRAINING import GeneticAlgorithm
population_size = 32
generations = 100
mutation_rate = 0.5
training_interval = 150  # Train the agent every 25 steps
total_episodes = 1  # Number of episodes per evaluation

# Initialize environment
env = WormSimulationEnv(num_worms=population_size)
# Initialize and run the Genetic Algorithm
#ga = GeneticAlgorithm(population_size, len(all_neuron_names), mutation_rate, total_episodes, training_interval)
#best_weight_matrix = ga.run(env, generations)
#print("Best weight matrix found:", best_weight_matrix)

GeneticRUN(gene, total_episodes, training_interval).run(env)


env.close()

